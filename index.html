<!DOCTYPE html>
<html lang="en">
  <head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <title>#offlinetrello</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.0/knockout-min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
  </head>
  <body>
    <div class="board" data-bind="trelloBoard: board, with: board">
      <div class="header">
        <span><a href="https://www.github.com/">Offline Trello Browser</a></span>
        <span>by <a target="_blank" href="https://twitter.com/intent/tweet?via=gurubobnz&hashtags=TrelloOffline">@gurubobnz</a></span>
      </div>
      <div class="d-flex justify-content-between board-header">
        <div class="board-header-btn mod-board-name">
          <span class="board-header-btn-text" data-bind="text: name"></span>
        </div>
      </div>
      <div id="content">
        <div class="board-wrapper">
          <div data-bind="foreach: lists">
            <!--ko ifnot: closed -->
            <div class="list-wrapper">
              <div class="list">
                <div class="list-header">
                  <span class="list-header-name" data-bind="text: name"></span>
                </div>
                <div class="list-cards">
                  <div data-bind="foreach: cards">
                    <div data-bind="click: $parents[1].openCard, template: 'card'"></div>
                  </div>
                </div>
              </div>
            </div>
            <!-- /ko -->
          </div>
        </div>
      </div>

      <!-- ko if: currentlyOpenCard -->
      <div class="open-card" data-bind="with: currentlyOpenCard">
        <div class="background" data-bind="click: $parent.closeCard"></div>
        <div class="window">
          <div class="window-header">
            <div class="d-flex justify-content-between">
              <h2 class="card-title" data-bind="text: name"></h2>
              <a class="quiet" target="_blank" data-bind="attr:{href: url}">Open</a>
            </div>
            <p class="quiet u-inline-block u-bottom">in list <a href="#" data-bind="text: function() { return $parent.getListById(idList).name }()"></a></p>
            <!-- ko if: members -->
            <div>
              <span class="quiet strong caps">Members</span>
              <div class="d-flex">
                <div class="flex-grow-0" data-bind="foreach: members">
                  <!-- ko template: 'avatar' --><!-- /ko -->
                </div>
              </div>
            </div>
            <!-- /ko -->
          </div>
          <div class="window-main-col px-4">
            <div class="row window-module">
              <div class="col icon-column">
                <i class="fa fa-align-left"></i>
              </div>
              <div class="col">
                <h3>Description</h3>
              </div>
            </div>

            <!-- ko foreach: checklists -->
              <div class="window-module checklist">
                <!-- ko template: 'checklist' --><!-- /ko -->
              </div>
            <!-- /ko -->

            <!-- ko foreach: actions -->
              <div class="window-module" data-bind="template: 'action'"></div>
            <!-- /ko -->
          </div>
        </div>
      </div>
      <!-- /ko -->
    </div>
    
  </body>

  <script type="text/html" id="card">
    <div class="list-card">
      <div class="list-card-cover" data-bind="trelloCardCover: $data"></div>
      <div class="list-card-details">
        <span class="list-card-title" data-bind="text: name"></span>
      </div>
    </div>
  </script>

  <script type="text/html" id="action">
    <div class="row no-gutters d-flex">
      <div class="col flex-grow-0 pr-2 icon-column" data-bind="with: member">
        <!-- ko template: 'avatar' --><!-- /ko -->
      </div>
      <div class="col">
        <p>
          <!-- <strong data-bind="text: member.fullName"></strong> -->
          <span class="quiet" data-bind="text: date"></span>
        </p>
        <p data-bind="text: ko.toJSON($data, null, 2)"></p>
      </div>
    </div>
  </script>

  <script type="text/html" id="avatar">
    <!-- ko if: avatarUrl -->
    <img class="avatar" data-bind="attr:{title: description, src: avatarUrl}" />
    <!-- /ko -->
    <!-- ko ifnot: avatarUrl -->
    <span class="avatar d-flex align-items-center justify-content-center">
      <span data-bind="text: initials, attr:{title: description}"></span>
    </span>
    <!-- /ko -->
  </script>

  <script type="text/html" id="checklist">
    <div class="row justify-content-between align-items-center">
      <div class="col icon-column">
        <i class="far fa-check-square"></i>
      </div>
      <div class="flex-grow-1">
        <h3 data-bind="text: name"></h3>
      </div>
      <button class="flex-align-end btn btn-success mr-3" data-bind="click: toggleHideCompleted">
        <span data-bind="ifnot: hideCompleted">Hide completed items</span>
        <span data-bind="if: hideCompleted">Show checked items (<span data-bind="text: function() { return items.length-visibleItems().length; }()"></span>)</span>
      </button>
    </div>

    <div class="row no-gutters align-items-center">
      <div class="col icon-column quiet tiny text-center pr-2">
        <span data-bind="text: prettyPercentComplete"></span>
      </div>
      <div class="col">
        <div class="progress">
          <div class="progress-bar" role="progressbar" data-bind="style: {width: function() { return percentComplete()+'%'; }()}"></div>
        </div>
      </div>
    </div>    

    <!-- ko foreach: visibleItems -->
    <div class="row d-flex flex-nowrap" data-bind="css: {'quiet': checked, 'is-checked': checked, 'is-not-checked': function() { return !checked() }()}">
      <div class="col icon-column">
        <div class="py-2">
          <!-- ko if: checked -->
            <i class="fa fa-check-square"></i>
          <!-- /ko -->
          <!-- ko ifnot: checked -->
            <i class="far fa-square"></i>
          <!-- /ko -->
        </div>
      </div>
      <div class="py-2" data-bind="text: name"></div>
    </div>
    <!-- /ko -->
  </script>

</html>
